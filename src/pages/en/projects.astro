---
import BaseLayout from '@layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import ProjectsRoadmapVisualization from '@components/ProjectsRoadmapVisualization';

const lang = 'en';

const projectsCollection = (await getCollection('projects'))
  .filter(project => project.data.lang === lang)
  .sort((a, b) => (b.data.featured ? 1 : 0) - (a.data.featured ? 1 : 0));

// Transform projects for visualization
const projects = projectsCollection.map(project => ({
  id: project.id,
  title: project.data.title,
  description: project.data.description,
  version: project.data.version,
  status: project.data.status,
  tags: project.data.tags,
  github: project.data.github,
  link: project.data.link,
  projectType: project.data.projectType,
  category: project.data.category,
  parentProject: project.data.parentProject,
  roadmap: project.data.roadmap,
}));
---

<BaseLayout title="Projects - vremyavnikuda" description="Personal projects and open source contributions">
  <div class="max-w-7xl mx-auto px-4 py-8">
    {projects.length === 0 ? (
      <p class="text-[var(--color-text-secondary)]">Projects coming soon!</p>
    ) : (
      <ProjectsRoadmapVisualization projects={projects} client:load />
    )}
  </div>
</BaseLayout>
